{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "description": "Global dot map using Equal Earth projection; dimensions and colours matched to idiom (background, land, graticules, strokes).",
  "width": 840,
  "height": 520,
  "background": "#c6dbef",
  "data": {
    "url": "https://raw.githubusercontent.com/James-Monash/FIT3179_Assignment_2/main/110m_worldmap.json",
    "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
  },
  "projection": {
    "type": "equalEarth",
    "scale": 190,
    "translate": [420, 260]
  },
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/James-Monash/FIT3179_Assignment_2/main/110m_worldwide_30_degree_graticules.json",
        "format": { "type": "topojson", "feature": "ne_110m_graticules_30" }
      },
      "mark": { "type": "geoshape", "fill": "transparent", "stroke": "#ccc", "strokeWidth": 0.9 }
    },
    {
      "mark": { "type": "geoshape", "fill": "#f7f3ea", "stroke": "#999", "strokeWidth": 1 }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/James-Monash/FIT3179_Assignment_2/main/deadliest_tornadoes.csv",
        "format": { "type": "csv" }
      },
      "transform": [
        { "calculate": "datum.lat === '' || datum.lat === null ? null : toNumber(datum.lat)", "as": "lat_num" },
        { "calculate": "datum.lon === '' || datum.lon === null ? null : toNumber(datum.lon)", "as": "lon_num" },
        { "calculate": "datum.deaths === '' || datum.deaths === null ? null : toNumber(datum.deaths)", "as": "deaths_num" },
        { "filter": "isFinite(datum.lat_num) && isFinite(datum.lon_num) && datum.lat_num !== 0 && datum.lon_num !== 0" }
      ],
      "mark": { "type": "circle", "opacity": 0.8, "stroke": "#ffffff", "strokeWidth": 0.8 },
      "encoding": {
        "longitude": { "field": "lon_num", "type": "quantitative" },
        "latitude": { "field": "lat_num", "type": "quantitative" },
        "size": {
          "field": "deaths_num",
          "type": "quantitative",
          "scale": { "domain": [1, 1300], "range": [30, 700] },
          "legend": null
        },
        "color": {
          "field": "country",
          "type": "nominal",
          "scale": {
            "domain": ["Bangladesh","United States","Russia","Italy","Malta","Argentina","Australia"],
            "range": ["#E69F00","#56B4E9","#009E73","#F0E442","#0072B2","#D55E00","#CC79A7"]
          },
          "legend": null
        },
        "tooltip": [
          { "field": "event", "type": "nominal", "title": "Event:" },
          { "field": "country", "type": "nominal", "title": "Country:" },
          { "field": "year", "type": "quantitative", "title": "Year:" },
          { "field": "deaths_num", "type": "quantitative", "title": "Fatalities:" }
        ]
      }
    }
  ],
  "config": { "view": { "stroke": "transparent" } }
}

